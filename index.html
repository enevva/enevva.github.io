<!DOCTYPE html>
<html>
<head>
	<meta charset="utf8">
</head>
<body>
	<select name="devices" id="devices"></select>
	<audio src="/assets/dollys_prtb.mp3" controls></audio>
	<script>
		!function(){
			const mediaFile = '/assets/dollys_prtb.mp3';
			const audio = document.querySelector('audio');
			const select = document.querySelector('select');
			navigator.mediaDevices.enumerateDevices().then(devices=>{
				devices.filter(device => device.kind === 'audiooutput').forEach(device=>{
					let option = document.createElement('option');
					option.value = device.deviceId;
					option.text = '[' + device.kind + '] ' + device.label;
					select.appendChild(option);
				})
			}).catch(error=>{
				console.log(error);
			});

			select.onchange = e => {
				audio.pause();
				const newAudio = document.createElement('audio');
				newAudio.setSinkId(this.value).then(result=>{
					newAudio.src = mediaFile;
					document.replaceChild(newAudio, audio);
					console.log(result);
				}).catch(error=>{
					console.log(error);
				})
			}
		}();
	</script>
</body>
</html>
